name: CI - self-hosted test

on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: [ self-hosted, ppc64le ]
    steps:
      - uses: actions/checkout@v4
      - name: Prepare build tools
        run: |
          echo "Preparing build tools (may require sudo/apt)"
          sudo apt-get update -y || true
          sudo apt-get install -y build-essential || true
      - name: Build C sample
        run: |
          make -C . || gcc -O2 -Wall -o hello hello.c
      - name: Run C sample
        run: |
          echo "Running the compiled binary"
          ./hello || true
      - name: Show runner info
        run: |
          echo "Running on $(uname -m)"
          uname -a
          lscpu || true
          echo "Finished self-hosted ppc64le test"
